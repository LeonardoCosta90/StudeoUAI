{"version":3,"sources":["/home/leo/Documentos/projetos/mine/TCC/StudeoUAI/backend/studeouai-api/src/modules/accounts/services/update-user-avatar-service.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","sourcesContent":["import { S3StorageProvider } from '@shared/providers/storage-provider/s3-storage-provider';\nimport { AppError } from '@shared/errors/app-error';\nimport { getCustomRepository } from 'typeorm';\nimport { UpdateUserAvatarRequest } from '../models/update-avatar-request';\nimport { UsersRepository } from '../typeorm/repositories/users-repository';\n\nclass UpdateUserAvatarService {\n  async updateAvatarUser({\n    user_id,\n    avatar_file,\n  }: UpdateUserAvatarRequest): Promise<void> {\n    const userRepository = getCustomRepository(UsersRepository);\n    const userFound = await userRepository.findById(user_id);\n    const storageProvider = new S3StorageProvider();\n\n    if (!userFound) {\n      throw new AppError('User not found', 404);\n    }\n\n    if (userFound.avatar) {\n      await storageProvider.delete(userFound.avatar, 'avatar');\n    }\n\n    await storageProvider.save(avatar_file, 'avatar');\n\n    userFound.avatar = avatar_file;\n\n    await userRepository.create(userFound);\n  }\n}\n\nexport { UpdateUserAvatarService };\n"]}